-- QUERY 3G
SELECT 
EXTRACT(ISOWEEK FROM PARSE_DATE('%Y%m%d', CAST(ID_DWH_DIA AS STRING))) AS SEMANA,
  NODE,
  '4G' AS RAT,
  SUM(((N_ThpVol_UL)/(810241024))) AS UL_Traffic_5G_GB,
  SUM(((N_ThpVol_DL)/(810241024)))AS DL_Traffic_5G_GB,
  SUM(((N_ThpVol_DL+N_ThpVol_UL)/(810241024))) AS Total_Traffic_5G_GB
FROM 
  wom-edms-prod-d6d5.STG_TRAF.MAE_5G_CELL_COUNTERS_HOUR
WHERE 
  ID_DWH_DIA BETWEEN 20250721 AND 20250727
GROUP BY 
  NODE, SEMANA
ORDER BY 
  NODE ASC;



--- QUERY 4G
SELECT 
EXTRACT(ISOWEEK FROM PARSE_DATE('%Y%m%d', CAST(ID_DWH_DIA AS STRING))) AS SEMANA,
  NODE,
  '4G' AS RAT,
  SUM(((N_ThpVol_UL)/(810241024))) AS UL_Traffic_5G_GB,
  SUM(((N_ThpVol_DL)/(810241024)))AS DL_Traffic_5G_GB,
  SUM(((N_ThpVol_DL+N_ThpVol_UL)/(810241024))) AS Total_Traffic_5G_GB
FROM 
  wom-edms-prod-d6d5.STG_TRAF.MAE_5G_CELL_COUNTERS_HOUR
WHERE 
  ID_DWH_DIA BETWEEN 20250721 AND 20250727
GROUP BY 
  NODE, SEMANA
ORDER BY 
  NODE ASC;


--- QUERY 5G
SELECT 
EXTRACT(ISOWEEK FROM PARSE_DATE('%Y%m%d', CAST(ID_DWH_DIA AS STRING))) AS SEMANA,
  NODE,
  '4G' AS RAT,
  SUM(((N_ThpVol_UL)/(810241024))) AS UL_Traffic_5G_GB,
  SUM(((N_ThpVol_DL)/(810241024)))AS DL_Traffic_5G_GB,
  SUM(((N_ThpVol_DL+N_ThpVol_UL)/(810241024))) AS Total_Traffic_5G_GB
FROM 
  wom-edms-prod-d6d5.STG_TRAF.MAE_5G_CELL_COUNTERS_HOUR
WHERE 
  ID_DWH_DIA BETWEEN 20250721 AND 20250727
GROUP BY 
  NODE, SEMANA
ORDER BY 
  NODE ASC;
